<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualisation - Mood & Personality</title>
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/visualise.css') }}">
    <!-- Link to external JS file -->
    <script src="{{ url_for('static', filename='js/visualise.js') }}"></script>

</head>
<body>

    <!-- Background Section: Dark cosmic theme -->
    <section class="background">

        <nav class="navigation">
            <a href="{{ url_for('user.index') }}">Home</a>
            <a href="{{ url_for('friend.friends') }}">Friends</a>
            {% if is_friend_view %}
                <a href="{{ url_for('visual.visualise') }}">My Profile</a>
            {% endif %}
        </nav>
        
        <h1 class="page-title">Hi {{ first_name }}</h1>
         {% if is_friend_view %}
            {{ first_name }}'s Spotify Mood Analysis
        {% else %}
        Your Spotify Mood Analysis
        {% endif %}

        <h2 class="greeting">Your Spotify Mood Analysis</h2>
        <br>
        <p class="subheading">An overview of your mood patterns and music-driven personality</p>
    
    
    </section>



    <!-- Mood Cards Section -->
    <section class="mood-cards-container">
        <h2 class="section-title">Mood Breakdown</h2>
        <div class="mood-cards-scroll">

            {% for mood, count in mood_counts.items() %}
            <div class="mood-card">
                <div class="emoji">
                    {% if mood.lower() == 'happy' %}
                    üòä
                    {% elif mood.lower() == 'sad' %}
                    üò¢
                    {% elif mood.lower() == 'chill' %}
                    üßò‚Äç‚ôÇÔ∏è
                    {% elif mood.lower() == 'angry' %}
                    üò°
                    {% elif mood.lower() == 'focused' %}
                    üéØ
                    {% elif mood.lower() == 'energetic' %}
                    ‚ö°
                    {% elif mood.lower() == 'nostalgic' %}
                    üï∞Ô∏è
                    {% else %}
                    üéµ
                    {% endif %}          
                </div>
                <h3>{{ mood }}</h3>
                <p>{{ count }} track{{ 's' if count > 1 else '' }}</p>
                <h4 class="top-heading">Top Song</h4>

                <div class="top-song">
                    {% set top = mood_data[mood.lower()].top_track %}
                    <img src="{{ top.image }}" alt="Album cover" class="album-cover">
                    <div class="song-info">
                        <p class="song-title">{{ top.name }}</p>
                        <p class="song-artist">{{ top.artist }}</p>
                    </div>          
                </div>
            
                <p class="time-of-day">Usually felt at: Night (8pm-11pm)</p>
            
                <div class="recommendations">
                    <p class="recommend-title">Recommended Songs:</p>
                    <ul class="recommended-songs">
                        {% for rec in recommended_songs.get(mood, []) %}
                        <li class="song-item">
                            <img src="{{ rec.image_url }}" alt="Album cover" class="album-cover">
                            <div class="song-info">
                                <p class="song-title">{{ rec.name }}</p>
                                <p class="song-artist">{{ rec.artist }}</p>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endfor %}
                        
        </div>
    </section>

    <!-- Personality Card Section -->
    <section class="personality-card">
        <h2 class="section-title">Your Personality</h2>
        <div class="card-layout">
    
            <!-- Left: MBTI and AI-generated image -->
            <div class="left">
                <h3>{{ personality.mbti }}</h3>
                <img src="{{ personality.image }}" alt="AI-generated personality character">
                <h3>{{ first_name }}</h3>
            </div>
    
            <!-- Right: Summary and related songs -->
            <div class="centre">
                <p class="summary">{{ personality.summary }}</p>
                <p>Related Songs:</p>
                <ul class="related-songs">
                    {% for song in personality.related_songs %}
                    <li class="song-item">
                        <img src="{{ song.image }}" alt="Album cover" class="album-cover">
                        <div class="song-info">
                            <p class="song-title">{{ song.name }}</p>
                            <p class="song-artist">{{ song.artist }}</p>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
    
            <div class="clear"></div>
    
            <!-- Personality Summary (duplicate for design symmetry, optional) -->
            <div class="right">
                <p>{{ mood_summary }}</p>
            </div>
            
            
        </div>
        <button class="share-button">Share This Card</button>
    </section>

</body>
</html>